# 操作系统简介

程序运行做的事情：执行指令。处理器从内存取一条指令，解码后执行，完成后再继续执行下一条指令，直到程序完成。

操作系统实际做了什么：取得CPU、内存或磁盘等物理资源，对其进行虚拟化；处理并发；持久存储文件。

目标一：最小化操作系统的开销。目标二：应用程序间及OS和应用程序间提供保护，实现进程间彼此隔离。

# 虚拟化

为了让系统更易于使用，操作系统主要利用虚拟化技术。将物理资源转换为更通用、更强大且更易于使用的虚拟形式。

## 虚拟化内存

每个进程访问自己的私有虚拟地址空间，操作系统以某种方式映射到机器的物理内存上。

# 并发

## 持久性

磁盘不会被虚拟化。操作系统写入磁盘，首先确定数据要驻留在磁盘上的哪个位置，在文件系统维护的各种结构中对其记录。需要向底层存储设备发出IO请求，以读取现有结构或更新它们。为了提高性能，文件系统会延迟写操作一段时间，将其批量分组为较大的组。为处理写入期间系统崩溃，大多数文件系统都包含复杂的写入协议，如日志或写时复制，确保写入序列期间发生故障后可恢复到合理的状态。