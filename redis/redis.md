分布式缓存，要把数据水平切分到不同节点，某个 `key` 到哪个节点查，应该是确定的。用哈希

```mat
hash(key) % n
```

但如果节点数量变化，哈希值会变化，需要重新计算哈希迁移数据，迁移的数据量相对较大，成本高。

一致性哈希：对存储节点做哈希计算，如根据 `IP` 做哈希；当要存储访问 `key` 时，对 `key` 做哈希。将存储节点环上，环的范围是2^32。访问 `key` 时计算哈希，找到在环上的位置，顺时针遇到的第一个存储节点就是存放该 `key` 的节点。若节点数变化，能减少要迁移的数据，但不能保证节点分布均匀。

解决一致性哈希的分布不均问题，可加入虚拟节点，对一个真实节点做多个副本。不再将真实节点映射到哈希环，而是将虚拟节点映射到哈希环，再将虚拟节点映射到真实节点。